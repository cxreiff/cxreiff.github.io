
$background_noise: url(
    "data:image/png;base64,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"
);

$color-text-default: 'color-text-default';
$color-text-link: 'color-text-link';
$color-background-default: 'color-background-default';
$color-background-container: 'color-background-container';
$default-drop-shadow: 'default-drop-shadow';
$default-box-shadow: 'default-box-shadow';
$color-border-box-shadow: 'color-border-box-shadow';
$color-border-drop-shadow: 'color-border-drop-shadow';
$color-lighter: 'color-lighter';
$color-light: 'color-light';
$color-primary: 'color-primary';
$color-secondary: 'color-secondary';
$color-tertiary: 'color-tertiary';
$color-dark: 'color-dark';
$color-darker: 'color-darker';
$background-image-noise: 'background-image-noise';
$animation-fade-pulse: 'animation-fade-pulse';
$svg-brightness: 'svg-brightness';

$themes: (
   lightmode: (
        color-text-default: #000000,
        color-text-link: #AA7777,
        color-background-default: #FFFFFF,
        color-background-container: #221111,
        color-lighter: #EEEEEE,
        color-light: #EEDDDD,
        color-primary: #DDCCCC,
        color-secondary: #AA9999,
        color-tertiary: #AA7777,
        color-dark: #3D3333,
        color-darker: #221111,
        default-drop-shadow: (0 0 0 1px transparent, rgba(#3D3333, 0.5) 4px 4px 5px),
        default-box-shadow: (0 0 0 1px #3D3333, #3D3333 3px 3px, rgba(#3D3333, 0.5) 4px 4px 5px),
        animation-fade-pulse: animation-fade-pulse_lightmode,
        background-image-noise: $background_noise,
        svg-brightness: 0,
    ),
    bluish: (
        color-text-default: #000000,
        color-text-link: #7777AA,
        color-background-default: #FFFFFF,
        color-background-container: #111122,
        color-lighter: #EEEEEE,
        color-light: #DDDDEE,
        color-primary: #CCCCDD,
        color-secondary: #9999AA,
        color-tertiary: #7777AA,
        color-dark: #33333D,
        color-darker: #111122,
        default-drop-shadow: (0 0 0 1px transparent, rgba(#33333D, 0.5) 4px 4px 5px),
        default-box-shadow: (0 0 0 1px #33333D, #33333D 3px 3px, rgba(#33333D, 0.5) 4px 4px 5px),
        animation-fade-pulse: animation-fade-pulse_bluish,
        background-image-noise: $background_noise,
        svg-brightness: 0,
    ),
    greenish: (
        color-text-default: #000000,
        color-text-link: #77AA77,
        color-background-default: #FFFFFF,
        color-background-container: #112211,
        color-lighter: #EEEEEE,
        color-light: #DDEEDD,
        color-primary: #CCDDCC,
        color-secondary: #99AA99,
        color-tertiary: #77AA77,
        color-dark: #333D33,
        color-darker: #112211,
        default-drop-shadow: (0 0 0 1px transparent, rgba(#333D33, 0.5) 4px 4px 5px),
        default-box-shadow: (0 0 0 1px #333D33, #333D33 3px 3px, rgba(#333D33, 0.5) 4px 4px 5px),
        animation-fade-pulse: animation-fade-pulse_greenish,
        background-image-noise: $background_noise,
        svg-brightness: 0,
    ),
    darkmode: (
        color-text-default: #FFFFFF,
        color-text-link: #CC99CC,
        color-background-default: #000000,
        color-background-container: #000000,
        color-lighter: #111111,
        color-light: #554455,
        color-primary: #000000,
        color-secondary: #AA99AA,
        color-tertiary: #AA77AA,
        color-dark: #CCCDCC,
        color-darker: #EEDDEE,
        default-drop-shadow: 0 0 0 1px #BBBDBB,
        default-box-shadow: 0 0 0 1px #BBBDBB,
        animation-fade-pulse: animation-fade-pulse_darkmode,
        background-image-noise: none,
        svg-brightness: 0.9,
    ),
);

@mixin themed($fade: false) {
    @each $theme, $map in $themes {
        :global(.theme--#{$theme}) & {
            $theme-map: () !global;
            @each $key, $submap in $map {
                $value: map-get($map, '#{$key}');
                $theme-map: map-merge($theme-map, ($key: $value)) !global;
            }
            @content;
            $theme-map: null !global;
        }
        @if ($fade) {
            :global(.theme--transition) & {
                @include color_transitions();
            }
        }
    }
}

@function t($key) {
    @return map-get($theme-map, $key);
}

@function value_by_theme($theme, $key) {
    @return map-get(map-get($themes, $theme), '#{$key}');
}

@mixin color_transitions() {
    transition: color 0.2s ease-out,
        background 0.2s ease-out,
        background-color 0.2s ease-out,
        border-color 0.2s ease-out,
        box-shadow 0.2s ease-out,
        text-shadow 0.2s ease-out,
        stroke 0.2s ease-out,
        filter 0.2s ease-out;
}

@each $theme, $map in $themes {
    @keyframes animation-fade-pulse_#{$theme} {
        0% {
            opacity: 0.3;
            background: map-get($map, $color-secondary);
        }

        40% {
            opacity: 1;
            background: map-get($map, $color-tertiary);
        }

        80% {
            opacity: 0.3;
            background: map-get($map, $color-secondary);
        }
    }
}
